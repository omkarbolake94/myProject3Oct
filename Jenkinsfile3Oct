pipeline{

agent{

dockerfile {args '--user root -v /var/run/docker.sock:/var/run/docker.sock'}

}


stages{
 
 stage('Build Code'){
 
 steps{
 sh 'mvn clean package'
 }
 
 }

stage('Build Docker Image'){
environment{
DOCKER_IMAGE = "v:${BUILD_NUMBER}"
}

steps{

sh 'docker build -t ${DOCKER_IMAGE} -f Dockerfile2 .'
}

}


}

}
