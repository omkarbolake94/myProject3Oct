pipeline{

 environment {
        BUILD_NUM = ''

    }

agent{

dockerfile {args '--user root -v /var/run/docker.sock:/var/run/docker.sock'}

}

stages{
 
 stage('Build Code'){
 
 steps{
 sh 'mvn clean package'
 }
 
 }

stage('Build Docker Image'){


steps{
script{
def build_num1 = build_job.getNumber()
BUILD_NUM = "${build_num1}"
sh 'docker build -t "v:${BUILD_NUM}" -f Dockerfile2 .'
}
}

}


}

}
